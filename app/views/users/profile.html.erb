<div class="question-content">
  <div class="test-case">
    <div class="row">
      <div class="col-lg-3">
        <h3 class="title"> Профиль: </h3>
        <table class="table table-bordered">
          <tr>
            <td><strong>Имя:</strong></td>
            <td><%= @user.first_name %></td>
          </tr>
          <tr>
          <tr>
            <td><strong>Отчество:</strong></td>
            <td><%= @user.second_name %></td>
          </tr>
          <tr>
            <td><strong>Фамилия:</strong></td>
            <td><%= @user.last_name %></td>
          </tr>
          <tr>
            <td><strong>Работа:</strong></td>
            <td><%= @user.job %></td>
          </tr>
        </table>
      </div>
      <% if @user.roles.first.name == 'Тестируемый' %>
          <div class="col-lg-9">
            <h3 class="title"> Список Аттестационных тестов: </h3>

            <table class="table table-bordered">
              <thead>
              <tr>
                <th>Название:</th>
                <th>Описание:</th>
                <th>Алгоритм:</th>
                <th>Задания:</th>
              </tr>
              </thead>
              <tbody>
              <% @attestation_tests.each do |test| %>
                  <tr>
                    <td><%= test.title %></td>
                    <td><%= test.description %></td>
                    <td><%= test.algorithm %></td>
                    <td><%= test.tasks.count %></td>
                  </tr>
              <% end %>
              </tbody>
            </table>
          </div>
      <% end %>
    </div>
    <div class="row">
      <hr/>
      <div class="col-lg-12">
        <h3>История</h3>
        <table class="table table-bordered">
          <thead>
          <tr>
            <th>Название:</th>
            <th>Дата:</th>
            <th>Время:</th>
            <th>Статус:</th>
            <th>Правильность:</th>
            <th>Оценка:</th>
          </tr>
          </thead>
          <tbody>
          <% @tries.each do |try| %>
              <tr>
                <td><%= try.test.title %></td>
                <td><%= try.date %></td>
                <td><%= try.timer.strftime('%H:%M') %></td>
                <td>
                  <span class="label <%= try.status == 'Выполнен' ? 'label-success' : 'label-danger' %> "><%= try.status %></span>
                </td>
                <td style="text-align: center"><%= try.rate.nil? ? '' : try.rate.round().to_s + '%' %></td>
                <td>
                  <% if !try.rate.nil? %>
                      <% if try.rate > 92 %>
                          <%= 'Отлично' %>
                      <% elsif try.rate >= 70 %>
                          <%= 'Хорошо' %>
                      <% elsif try.rate >= 50 %>
                          <%= 'Удовл.' %>
                      <% else %>
                          <%= 'Неуд.' %>
                      <% end %>
                  <% end %>
                </td>
              </tr>
          <% end if @tries %>
          </tbody>
        </table>
      </div>
    </div>
    <% if (current_user.roles.first.name == 'Администратор') && (@user.roles.first.name == 'Тестируемый') %>
        <div class="row">
          <div class="col-lg-12">
            <hr/>
            <h3 class="title"> Поиск Аттестационных тестов </h3>
            <%= form_tag(profile_user_path, :method => 'get') do %>
                <div class="col-lg-8">
                  <%= text_field_tag :search_tests, params[:search_tests], :class => 'form-control' %>
                </div>
                <div class="col-lg-offset-2">
                  <%= button_tag(type: 'submit', class: 'btn btn-default') do %>
                      Поиск <span class="glyphicon glyphicon-search"></span>
                  <% end %>
                </div>
            <% end %>
          </div>
        </div>
        <br/>
        <div class="row">
          <div class="col-lg-12">
            <table class="table table-bordered">
              <thead>
              <tr>
                <th>Название:</th>
                <th>Описание:</th>
                <th>Алгоритм:</th>
                <th>Задания:</th>
                <th>Добавить:</th>
              </tr>
              </thead>
              <tbody>
              <% if @tests_search %>
                  <% @tests_search.where(:attestation => true).each do |test| %>
                      <tr>
                        <td><%= test.title %></td>
                        <td><%= test.description %></td>
                        <td><%= test.algorithm %></td>
                        <td><%= test.tasks.count %></td>
                        <td><%= link_to 'Добавить', add_attestation_tests_user_path(@user.id, attestation_id: test.id), :class => 'btn btn-default btn-xs' %></td>
                      </tr>
                  <% end %>
              <% end %>
              </tbody>
            </table>
          </div>
        </div>
    <% elsif current_user.roles.first.name == 'Тестируемый' %>

    <% end %>
  </div>

</div>


